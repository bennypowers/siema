{"version":3,"file":"siema.es.js","sources":["../src/siema.js"],"sourcesContent":["/**\n * Hi :-) This is a class representing a Siema.\n */\nexport default class Siema {\n  /**\n   * Create a Siema.\n   * @param {Object} options - Optional settings object.\n   */\n  constructor(options) {\n    // Merge defaults with user's settings\n    this.config = Siema.mergeSettings(options);\n\n    // Resolve selector's type\n    this.selector = typeof this.config.selector === 'string' ? document.querySelector(this.config.selector) : this.config.selector;\n\n    // Early throw if selector doesn't exists\n    if (this.selector === null) {\n      throw new Error('Something wrong with your selector ðŸ˜­');\n    }\n\n    // update perPage number dependable of user value\n    this.resolveSlidesNumber();\n\n    // Create global references\n    this.selectorWidth = this.selector.offsetWidth;\n    this.innerElements = [].slice.call(this.selector.children);\n    this.currentSlide = this.config.loop ?\n      this.config.startIndex % this.innerElements.length :\n      Math.max(0, Math.min(this.config.startIndex, this.innerElements.length - this.perPage));\n    this.transformProperty = Siema.webkitOrNot();\n\n    // Bind all event handlers for referencability\n    ['resizeHandler', 'touchstartHandler', 'touchendHandler', 'touchmoveHandler', 'mousedownHandler', 'mouseupHandler', 'mouseleaveHandler', 'mousemoveHandler', 'clickHandler'].forEach(method => {\n      this[method] = this[method].bind(this);\n    });\n\n    // Build markup and apply required styling to elements\n    this.init();\n  }\n\n\n  /**\n   * Overrides default settings with custom ones.\n   * @param {Object} options - Optional settings object.\n   * @returns {Object} - Custom Siema settings.\n   */\n  static mergeSettings(options) {\n    const settings = {\n      selector: '.siema',\n      duration: 200,\n      easing: 'ease-out',\n      perPage: 1,\n      startIndex: 0,\n      draggable: true,\n      multipleDrag: true,\n      threshold: 20,\n      loop: false,\n      rtl: false,\n      onInit: () => {},\n      onChange: () => {},\n    };\n\n    const userSttings = options;\n    for (const attrname in userSttings) {\n      settings[attrname] = userSttings[attrname];\n    }\n\n    return settings;\n  }\n\n\n  /**\n   * Determine if browser supports unprefixed transform property.\n   * Google Chrome since version 26 supports prefix-less transform\n   * @returns {string} - Transform property supported by client.\n   */\n  static webkitOrNot() {\n    const style = document.documentElement.style;\n    if (typeof style.transform === 'string') {\n      return 'transform';\n    }\n    return 'WebkitTransform';\n  }\n\n  /**\n   * Attaches listeners to required events.\n   */\n  attachEvents() {\n    // Resize element on window resize\n    window.addEventListener('resize', this.resizeHandler);\n\n    // If element is draggable / swipable, add event handlers\n    if (this.config.draggable) {\n      // Keep track pointer hold and dragging distance\n      this.pointerDown = false;\n      this.drag = {\n        startX: 0,\n        endX: 0,\n        startY: 0,\n        letItGo: null,\n        preventClick: false,\n      };\n\n      // Touch events\n      this.selector.addEventListener('touchstart', this.touchstartHandler);\n      this.selector.addEventListener('touchend', this.touchendHandler);\n      this.selector.addEventListener('touchmove', this.touchmoveHandler);\n\n      // Mouse events\n      this.selector.addEventListener('mousedown', this.mousedownHandler);\n      this.selector.addEventListener('mouseup', this.mouseupHandler);\n      this.selector.addEventListener('mouseleave', this.mouseleaveHandler);\n      this.selector.addEventListener('mousemove', this.mousemoveHandler);\n\n      // Click\n      this.selector.addEventListener('click', this.clickHandler);\n    }\n  }\n\n\n  /**\n   * Detaches listeners from required events.\n   */\n  detachEvents() {\n    window.removeEventListener('resize', this.resizeHandler);\n    this.selector.removeEventListener('touchstart', this.touchstartHandler);\n    this.selector.removeEventListener('touchend', this.touchendHandler);\n    this.selector.removeEventListener('touchmove', this.touchmoveHandler);\n    this.selector.removeEventListener('mousedown', this.mousedownHandler);\n    this.selector.removeEventListener('mouseup', this.mouseupHandler);\n    this.selector.removeEventListener('mouseleave', this.mouseleaveHandler);\n    this.selector.removeEventListener('mousemove', this.mousemoveHandler);\n    this.selector.removeEventListener('click', this.clickHandler);\n  }\n\n\n  /**\n   * Builds the markup and attaches listeners to required events.\n   */\n  init() {\n    this.attachEvents();\n\n    // hide everything out of selector's boundaries\n    this.selector.style.overflow = 'hidden';\n\n    // rtl or ltr\n    this.selector.style.direction = this.config.rtl ? 'rtl' : 'ltr';\n\n    // build a frame and slide to a currentSlide\n    this.buildSliderFrame();\n\n    this.config.onInit.call(this);\n  }\n\n\n  /**\n   * Build a sliderFrame and slide to a current item.\n   */\n  buildSliderFrame() {\n    const widthItem = this.selectorWidth / this.perPage;\n    const itemsToBuild = this.config.loop ? this.innerElements.length + (2 * this.perPage) : this.innerElements.length;\n\n    // Create frame and apply styling\n    this.sliderFrame = document.createElement('div');\n    this.sliderFrame.style.width = `${widthItem * itemsToBuild}px`;\n    this.enableTransition();\n\n    if (this.config.draggable) {\n      this.selector.style.cursor = '-webkit-grab';\n    }\n\n    // Create a document fragment to put slides into it\n    const docFragment = document.createDocumentFragment();\n\n    // Loop through the slides, add styling and add them to document fragment\n    if (this.config.loop) {\n      for (let i = this.innerElements.length - this.perPage; i < this.innerElements.length; i++) {\n        const element = this.buildSliderFrameItem(this.innerElements[i].cloneNode(true));\n        docFragment.appendChild(element);\n      }\n    }\n    for (let i = 0; i < this.innerElements.length; i++) {\n      const element = this.buildSliderFrameItem(this.innerElements[i]);\n      docFragment.appendChild(element);\n    }\n    if (this.config.loop) {\n      for (let i = 0; i < this.perPage; i++) {\n        const element = this.buildSliderFrameItem(this.innerElements[i].cloneNode(true));\n        docFragment.appendChild(element);\n      }\n    }\n\n    // Add fragment to the frame\n    this.sliderFrame.appendChild(docFragment);\n\n    // Clear selector (just in case something is there) and insert a frame\n    this.selector.innerHTML = '';\n    this.selector.appendChild(this.sliderFrame);\n\n    // Go to currently active slide after initial build\n    this.slideToCurrent();\n  }\n\n  buildSliderFrameItem(elm) {\n    const elementContainer = document.createElement('div');\n    elementContainer.style.cssFloat = this.config.rtl ? 'right' : 'left';\n    elementContainer.style.float = this.config.rtl ? 'right' : 'left';\n    elementContainer.style.width = `${this.config.loop ? 100 / (this.innerElements.length + (this.perPage * 2)) : 100 / (this.innerElements.length)}%`;\n    elementContainer.appendChild(elm);\n    return elementContainer;\n  }\n\n\n  /**\n   * Determinates slides number accordingly to clients viewport.\n   */\n  resolveSlidesNumber() {\n    if (typeof this.config.perPage === 'number') {\n      this.perPage = this.config.perPage;\n    }\n    else if (typeof this.config.perPage === 'object') {\n      this.perPage = 1;\n      for (const viewport in this.config.perPage) {\n        if (window.innerWidth >= viewport) {\n          this.perPage = this.config.perPage[viewport];\n        }\n      }\n    }\n  }\n\n\n  /**\n   * Go to previous slide.\n   * @param {number} [howManySlides=1] - How many items to slide backward.\n   * @param {function} callback - Optional callback function.\n   */\n  prev(howManySlides = 1, callback) {\n    // early return when there is nothing to slide\n    if (this.innerElements.length <= this.perPage) {\n      return;\n    }\n\n    const beforeChange = this.currentSlide;\n\n    if (this.config.loop) {\n      const isNewIndexClone = this.currentSlide - howManySlides < 0;\n      if (isNewIndexClone) {\n        this.disableTransition();\n\n        const mirrorSlideIndex = this.currentSlide + this.innerElements.length;\n        const mirrorSlideIndexOffset = this.perPage;\n        const moveTo = mirrorSlideIndex + mirrorSlideIndexOffset;\n        const offset = (this.config.rtl ? 1 : -1) * moveTo * (this.selectorWidth / this.perPage);\n        const dragDistance = this.config.draggable ? this.drag.endX - this.drag.startX : 0;\n\n        this.sliderFrame.style[this.transformProperty] = `translate3d(${offset + dragDistance}px, 0, 0)`;\n        this.currentSlide = mirrorSlideIndex - howManySlides;\n      }\n      else {\n        this.currentSlide = this.currentSlide - howManySlides;\n      }\n    }\n    else {\n      this.currentSlide = Math.max(this.currentSlide - howManySlides, 0);\n    }\n\n    if (beforeChange !== this.currentSlide) {\n      this.slideToCurrent(this.config.loop);\n      this.config.onChange.call(this);\n      if (callback) {\n        callback.call(this);\n      }\n    }\n  }\n\n\n  /**\n   * Go to next slide.\n   * @param {number} [howManySlides=1] - How many items to slide forward.\n   * @param {function} callback - Optional callback function.\n   */\n  next(howManySlides = 1, callback) {\n    // early return when there is nothing to slide\n    if (this.innerElements.length <= this.perPage) {\n      return;\n    }\n\n    const beforeChange = this.currentSlide;\n\n    if (this.config.loop) {\n      const isNewIndexClone = this.currentSlide + howManySlides > this.innerElements.length - this.perPage;\n      if (isNewIndexClone) {\n        this.disableTransition();\n\n        const mirrorSlideIndex = this.currentSlide - this.innerElements.length;\n        const mirrorSlideIndexOffset = this.perPage;\n        const moveTo = mirrorSlideIndex + mirrorSlideIndexOffset;\n        const offset = (this.config.rtl ? 1 : -1) * moveTo * (this.selectorWidth / this.perPage);\n        const dragDistance = this.config.draggable ? this.drag.endX - this.drag.startX : 0;\n\n        this.sliderFrame.style[this.transformProperty] = `translate3d(${offset + dragDistance}px, 0, 0)`;\n        this.currentSlide = mirrorSlideIndex + howManySlides;\n      }\n      else {\n        this.currentSlide = this.currentSlide + howManySlides;\n      }\n    }\n    else {\n      this.currentSlide = Math.min(this.currentSlide + howManySlides, this.innerElements.length - this.perPage);\n    }\n    if (beforeChange !== this.currentSlide) {\n      this.slideToCurrent(this.config.loop);\n      this.config.onChange.call(this);\n      if (callback) {\n        callback.call(this);\n      }\n    }\n  }\n\n\n  /**\n   * Disable transition on sliderFrame.\n   */\n  disableTransition() {\n    this.sliderFrame.style.webkitTransition = `all 0ms ${this.config.easing}`;\n    this.sliderFrame.style.transition = `all 0ms ${this.config.easing}`;\n  }\n\n\n  /**\n   * Enable transition on sliderFrame.\n   */\n  enableTransition() {\n    this.sliderFrame.style.webkitTransition = `all ${this.config.duration}ms ${this.config.easing}`;\n    this.sliderFrame.style.transition = `all ${this.config.duration}ms ${this.config.easing}`;\n  }\n\n\n  /**\n   * Go to slide with particular index\n   * @param {number} index - Item index to slide to.\n   * @param {function} callback - Optional callback function.\n   */\n  goTo(index, callback) {\n    if (this.innerElements.length <= this.perPage) {\n      return;\n    }\n    const beforeChange = this.currentSlide;\n    this.currentSlide = this.config.loop ?\n      index % this.innerElements.length :\n      Math.min(Math.max(index, 0), this.innerElements.length - this.perPage);\n    if (beforeChange !== this.currentSlide) {\n      this.slideToCurrent();\n      this.config.onChange.call(this);\n      if (callback) {\n        callback.call(this);\n      }\n    }\n  }\n\n\n  /**\n   * Moves sliders frame to position of currently active slide\n   */\n  slideToCurrent(enableTransition) {\n    const currentSlide = this.config.loop ? this.currentSlide + this.perPage : this.currentSlide;\n    const offset = (this.config.rtl ? 1 : -1) * currentSlide * (this.selectorWidth / this.perPage);\n\n    if (enableTransition) {\n      // This one is tricky, I know but this is a perfect explanation:\n      // https://youtu.be/cCOL7MC4Pl0\n      requestAnimationFrame(() => {\n        requestAnimationFrame(() => {\n          this.enableTransition();\n          this.sliderFrame.style[this.transformProperty] = `translate3d(${offset}px, 0, 0)`;\n        });\n      });\n    }\n    else {\n      this.sliderFrame.style[this.transformProperty] = `translate3d(${offset}px, 0, 0)`;\n    }\n  }\n\n\n  /**\n   * Recalculate drag /swipe event and reposition the frame of a slider\n   */\n  updateAfterDrag() {\n    const movement = (this.config.rtl ? -1 : 1) * (this.drag.endX - this.drag.startX);\n    const movementDistance = Math.abs(movement);\n    const howManySliderToSlide = this.config.multipleDrag ? Math.ceil(movementDistance / (this.selectorWidth / this.perPage)) : 1;\n\n    const slideToNegativeClone = movement > 0 && this.currentSlide - howManySliderToSlide < 0;\n    const slideToPositiveClone = movement < 0 && this.currentSlide + howManySliderToSlide > this.innerElements.length - this.perPage;\n\n    if (movement > 0 && movementDistance > this.config.threshold && this.innerElements.length > this.perPage) {\n      this.prev(howManySliderToSlide);\n    }\n    else if (movement < 0 && movementDistance > this.config.threshold && this.innerElements.length > this.perPage) {\n      this.next(howManySliderToSlide);\n    }\n    this.slideToCurrent(slideToNegativeClone || slideToPositiveClone);\n  }\n\n\n  /**\n   * When window resizes, resize slider components as well\n   */\n  resizeHandler() {\n    // update perPage number dependable of user value\n    this.resolveSlidesNumber();\n\n    // relcalculate currentSlide\n    // prevent hiding items when browser width increases\n    if (this.currentSlide + this.perPage > this.innerElements.length) {\n      this.currentSlide = this.innerElements.length <= this.perPage ? 0 : this.innerElements.length - this.perPage;\n    }\n\n    this.selectorWidth = this.selector.offsetWidth;\n\n    this.buildSliderFrame();\n  }\n\n\n  /**\n   * Clear drag after touchend and mouseup event\n   */\n  clearDrag() {\n    this.drag = {\n      startX: 0,\n      endX: 0,\n      startY: 0,\n      letItGo: null,\n      preventClick: this.drag.preventClick\n    };\n  }\n\n\n  /**\n   * touchstart event handler\n   */\n  touchstartHandler(e) {\n    // Prevent dragging / swiping on inputs, selects and textareas\n    const ignoreSiema = ['TEXTAREA', 'OPTION', 'INPUT', 'SELECT'].indexOf(e.target.nodeName) !== -1;\n    if (ignoreSiema) {\n      return;\n    }\n\n    e.stopPropagation();\n    this.pointerDown = true;\n    this.drag.startX = e.touches[0].pageX;\n    this.drag.startY = e.touches[0].pageY;\n  }\n\n\n  /**\n   * touchend event handler\n   */\n  touchendHandler(e) {\n    e.stopPropagation();\n    this.pointerDown = false;\n    this.enableTransition();\n    if (this.drag.endX) {\n      this.updateAfterDrag();\n    }\n    this.clearDrag();\n  }\n\n\n  /**\n   * touchmove event handler\n   */\n  touchmoveHandler(e) {\n    e.stopPropagation();\n\n    if (this.drag.letItGo === null) {\n      this.drag.letItGo = Math.abs(this.drag.startY - e.touches[0].pageY) < Math.abs(this.drag.startX - e.touches[0].pageX);\n    }\n\n    if (this.pointerDown && this.drag.letItGo) {\n      e.preventDefault();\n      this.drag.endX = e.touches[0].pageX;\n      this.sliderFrame.style.webkitTransition = `all 0ms ${this.config.easing}`;\n      this.sliderFrame.style.transition = `all 0ms ${this.config.easing}`;\n\n      const currentSlide = this.config.loop ? this.currentSlide + this.perPage : this.currentSlide;\n      const currentOffset = currentSlide * (this.selectorWidth / this.perPage);\n      const dragOffset = (this.drag.endX - this.drag.startX);\n      const offset = this.config.rtl ? currentOffset + dragOffset : currentOffset - dragOffset;\n      this.sliderFrame.style[this.transformProperty] = `translate3d(${(this.config.rtl ? 1 : -1) * offset}px, 0, 0)`;\n    }\n  }\n\n\n  /**\n   * mousedown event handler\n   */\n  mousedownHandler(e) {\n    // Prevent dragging / swiping on inputs, selects and textareas\n    const ignoreSiema = ['TEXTAREA', 'OPTION', 'INPUT', 'SELECT'].indexOf(e.target.nodeName) !== -1;\n    if (ignoreSiema) {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n    this.pointerDown = true;\n    this.drag.startX = e.pageX;\n  }\n\n\n  /**\n   * mouseup event handler\n   */\n  mouseupHandler(e) {\n    e.stopPropagation();\n    this.pointerDown = false;\n    this.selector.style.cursor = '-webkit-grab';\n    this.enableTransition();\n    if (this.drag.endX) {\n      this.updateAfterDrag();\n    }\n    this.clearDrag();\n  }\n\n\n  /**\n   * mousemove event handler\n   */\n  mousemoveHandler(e) {\n    e.preventDefault();\n    if (this.pointerDown) {\n      // if dragged element is a link\n      // mark preventClick prop as a true\n      // to detemine about browser redirection later on\n      if (e.target.nodeName === 'A') {\n        this.drag.preventClick = true;\n      }\n\n      this.drag.endX = e.pageX;\n      this.selector.style.cursor = '-webkit-grabbing';\n      this.sliderFrame.style.webkitTransition = `all 0ms ${this.config.easing}`;\n      this.sliderFrame.style.transition = `all 0ms ${this.config.easing}`;\n\n      const currentSlide = this.config.loop ? this.currentSlide + this.perPage : this.currentSlide;\n      const currentOffset = currentSlide * (this.selectorWidth / this.perPage);\n      const dragOffset = (this.drag.endX - this.drag.startX);\n      const offset = this.config.rtl ? currentOffset + dragOffset : currentOffset - dragOffset;\n      this.sliderFrame.style[this.transformProperty] = `translate3d(${(this.config.rtl ? 1 : -1) * offset}px, 0, 0)`;\n    }\n  }\n\n\n  /**\n   * mouseleave event handler\n   */\n  mouseleaveHandler(e) {\n    if (this.pointerDown) {\n      this.pointerDown = false;\n      this.selector.style.cursor = '-webkit-grab';\n      this.drag.endX = e.pageX;\n      this.drag.preventClick = false;\n      this.enableTransition();\n      this.updateAfterDrag();\n      this.clearDrag();\n    }\n  }\n\n\n  /**\n   * click event handler\n   */\n  clickHandler(e) {\n    // if the dragged element is a link\n    // prevent browsers from folowing the link\n    if (this.drag.preventClick) {\n      e.preventDefault();\n    }\n    this.drag.preventClick = false;\n  }\n\n\n  /**\n   * Remove item from carousel.\n   * @param {number} index - Item index to remove.\n   * @param {function} callback - Optional callback to call after remove.\n   */\n  remove(index, callback) {\n    if (index < 0 || index >= this.innerElements.length) {\n      throw new Error('Item to remove doesn\\'t exist ðŸ˜­');\n    }\n\n    // Shift sliderFrame back by one item when:\n    // 1. Item with lower index than currenSlide is removed.\n    // 2. Last item is removed.\n    const lowerIndex = index < this.currentSlide;\n    const lastItem = this.currentSlide + this.perPage - 1 === index;\n\n    if (lowerIndex || lastItem) {\n      this.currentSlide--;\n    }\n\n    this.innerElements.splice(index, 1);\n\n    // build a frame and slide to a currentSlide\n    this.buildSliderFrame();\n\n    if (callback) {\n      callback.call(this);\n    }\n  }\n\n\n  /**\n   * Insert item to carousel at particular index.\n   * @param {HTMLElement} item - Item to insert.\n   * @param {number} index - Index of new new item insertion.\n   * @param {function} callback - Optional callback to call after insert.\n   */\n  insert(item, index, callback) {\n    if (index < 0 || index > this.innerElements.length + 1) {\n      throw new Error('Unable to inset it at this index ðŸ˜­');\n    }\n    if (this.innerElements.indexOf(item) !== -1) {\n      throw new Error('The same item in a carousel? Really? Nope ðŸ˜­');\n    }\n\n    // Avoid shifting content\n    const shouldItShift = index <= this.currentSlide > 0 && this.innerElements.length;\n    this.currentSlide = shouldItShift ? this.currentSlide + 1 : this.currentSlide;\n\n    this.innerElements.splice(index, 0, item);\n\n    // build a frame and slide to a currentSlide\n    this.buildSliderFrame();\n\n    if (callback) {\n      callback.call(this);\n    }\n  }\n\n\n  /**\n   * Prepernd item to carousel.\n   * @param {HTMLElement} item - Item to prepend.\n   * @param {function} callback - Optional callback to call after prepend.\n   */\n  prepend(item, callback) {\n    this.insert(item, 0);\n    if (callback) {\n      callback.call(this);\n    }\n  }\n\n\n  /**\n   * Append item to carousel.\n   * @param {HTMLElement} item - Item to append.\n   * @param {function} callback - Optional callback to call after append.\n   */\n  append(item, callback) {\n    this.insert(item, this.innerElements.length + 1);\n    if (callback) {\n      callback.call(this);\n    }\n  }\n\n\n  /**\n   * Removes listeners and optionally restores to initial markup\n   * @param {boolean} restoreMarkup - Determinants about restoring an initial markup.\n   * @param {function} callback - Optional callback function.\n   */\n  destroy(restoreMarkup = false, callback) {\n    this.detachEvents();\n\n    this.selector.style.cursor = 'auto';\n\n    if (restoreMarkup) {\n      const slides = document.createDocumentFragment();\n      for (let i = 0; i < this.innerElements.length; i++) {\n        slides.appendChild(this.innerElements[i]);\n      }\n      this.selector.innerHTML = '';\n      this.selector.appendChild(slides);\n      this.selector.removeAttribute('style');\n    }\n\n    if (callback) {\n      callback.call(this);\n    }\n  }\n}\n"],"names":["Siema","[object Object]","options","this","config","mergeSettings","selector","document","querySelector","Error","resolveSlidesNumber","selectorWidth","offsetWidth","innerElements","slice","call","children","currentSlide","loop","startIndex","length","Math","max","min","perPage","transformProperty","webkitOrNot","forEach","method","bind","init","settings","duration","easing","draggable","multipleDrag","threshold","rtl","onInit","onChange","userSttings","attrname","documentElement","style","transform","window","addEventListener","resizeHandler","pointerDown","drag","startX","endX","startY","letItGo","preventClick","touchstartHandler","touchendHandler","touchmoveHandler","mousedownHandler","mouseupHandler","mouseleaveHandler","mousemoveHandler","clickHandler","removeEventListener","attachEvents","overflow","direction","buildSliderFrame","widthItem","itemsToBuild","sliderFrame","createElement","width","enableTransition","cursor","docFragment","createDocumentFragment","i","element","buildSliderFrameItem","cloneNode","appendChild","innerHTML","slideToCurrent","elm","elementContainer","cssFloat","float","viewport","innerWidth","howManySlides","callback","beforeChange","disableTransition","mirrorSlideIndex","moveTo","offset","dragDistance","webkitTransition","transition","index","requestAnimationFrame","movement","movementDistance","abs","howManySliderToSlide","ceil","slideToNegativeClone","slideToPositiveClone","prev","next","e","indexOf","target","nodeName","stopPropagation","touches","pageX","pageY","updateAfterDrag","clearDrag","preventDefault","currentOffset","dragOffset","lowerIndex","lastItem","splice","item","shouldItShift","insert","restoreMarkup","detachEvents","slides","removeAttribute"],"mappings":"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"}